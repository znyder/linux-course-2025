#!/bin/bash
# Förbered mappstruktur
installmapp=$(pwd)
grundmapp="laboration2"
undermappar=("katalog-1" "katalog-tva")
# Skapa filett.txt med innehåll 'fil ett' där vi exekverar skalprogrammet
echo "fil ett" > filett.txt
# Skapa mappstruktur, jag valde loop istället för "mkdir -p"
mkdir -p $grundmapp
# Ställ skalprogrammet i grundmappen vi precis skapade
cd $grundmapp
# Skapa två textfiler som innehåller text
echo "fil två" > filtvaa.txt
echo "fil tre" > filtree.txt
# Loopa igenom undermappar och skapa dess mappar
for mapp in ${undermappar[@]} ; do
mkdir $mapp
done
# Ställ skalprogrammet i katalog-1
cd ${undermappar[0]}
# Skapa datafil.txt under katalog-1
cat > datafil.txt <<EOF
Det här är datafil.txt i ${undermappar[0]}
Den kommer användas till att räkna rader
EOF
# Skapa skalprogrammet pgm.sh under katalog-1
cat > pgm.sh <<EOF
#!/bin/bash
# Sätt installationsmapp där pgm.sh ska köras
installkat=$installmapp/$grundmapp
# Om aktuell katalog INTE är densamma som installationsmappen, byt mapp med cd
if [ pwd != \$installkat/${undermappar[0]} ] ; then
cd \$installkat/${undermappar[0]}; fi
# Räkna antal rader för underma
norows1=(\$(wc -l \$installkat/${undermappar[0]}/datafil.txt))
echo -e Antal rader i datafil.txt i ${undermappar[0]}:\\n"\$norows1"st\\n
norows2=(\$(wc -l \$installkat/${undermappar[1]}/datafil.txt))
echo -e Antal rader i datafil.txt i ${undermappar[1]}:\\n"\$norows2"st\\n
echo -e Totalt antal rader från båda datafil.txt i ${undermappar[0]} och ${undermappar[1]}:\\n\$((\$norows1 + \$norows2))st
EOF
# Gör pgm.sh exekverbar
chmod +x pgm.sh
# Ställ skalprogrammet i katalog-tva genom att gå bakåt ett steg sen framåt
cd ..
cd ${undermappar[1]}
# Skapa datafil.txt under katalog-tva
cat > datafil.txt <<EOF
Det här är datafil.txt i ${undermappar[1]}
Den kommer användas till att räkna rader
Och den får innehålla tre(!) rader
EOF
# Skapa textfil som innehåller en rad text
echo "fil fyra" > filfyra.txt
exit
